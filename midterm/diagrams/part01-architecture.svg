<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 900 620" font-family="'Segoe UI', Arial, sans-serif">
  <defs>
    <marker id="arr" markerWidth="10" markerHeight="7" refX="10" refY="3.5" orient="auto">
      <polygon points="0 0, 10 3.5, 0 7" fill="#555"/>
    </marker>
    <marker id="arr-blue" markerWidth="10" markerHeight="7" refX="10" refY="3.5" orient="auto">
      <polygon points="0 0, 10 3.5, 0 7" fill="#2980b9"/>
    </marker>
    <marker id="arr-green" markerWidth="10" markerHeight="7" refX="10" refY="3.5" orient="auto">
      <polygon points="0 0, 10 3.5, 0 7" fill="#27ae60"/>
    </marker>
    <marker id="arr-red" markerWidth="10" markerHeight="7" refX="10" refY="3.5" orient="auto">
      <polygon points="0 0, 10 3.5, 0 7" fill="#c0392b"/>
    </marker>
    <marker id="arr-pgadmin" markerWidth="10" markerHeight="7" refX="10" refY="3.5" orient="auto">
      <polygon points="0 0, 10 3.5, 0 7" fill="#7f8c8d"/>
    </marker>
    <filter id="sh" x="-2%" y="-2%" width="104%" height="104%">
      <feDropShadow dx="1" dy="2" stdDeviation="2.5" flood-opacity="0.10"/>
    </filter>
  </defs>

  <!-- Title -->
  <text x="450" y="30" text-anchor="middle" font-size="17" font-weight="bold" fill="#2c3e50">Part 1 Architecture — Docker Compose Services</text>
  <text x="450" y="50" text-anchor="middle" font-size="11" fill="#888">5 containers on a shared Docker bridge network (week03_network)</text>

  <!-- ===== Docker network boundary ===== -->
  <rect x="30" y="65" width="840" height="490" rx="12" fill="none" stroke="#bdc3c7" stroke-width="1.5" stroke-dasharray="8,4"/>
  <text x="50" y="85" font-size="11" fill="#95a5a6" font-style="italic">week03_network  (Docker bridge)</text>

  <!-- =============== ROW 1: Three PostgreSQL databases =============== -->

  <!-- sales-db -->
  <g filter="url(#sh)">
    <rect x="60" y="105" width="230" height="165" rx="8" fill="#fff" stroke="#2980b9" stroke-width="2"/>
    <rect x="60" y="105" width="230" height="36" rx="8" fill="#2980b9"/>
    <rect x="60" y="130" width="230" height="11" fill="#2980b9"/>
    <text x="175" y="130" text-anchor="middle" font-size="14" font-weight="bold" fill="#fff">sales-db</text>
    <text x="78" y="162" font-size="11" fill="#333">PostgreSQL 16</text>
    <text x="78" y="180" font-size="11" fill="#555">Database: sales</text>
    <text x="78" y="198" font-size="11" fill="#555">Tables: customers, products, orders</text>
    <text x="78" y="218" font-size="10" fill="#888">Normalized (3NF)</text>
    <line x1="70" y1="230" x2="280" y2="230" stroke="#eee" stroke-width="1"/>
    <text x="78" y="248" font-size="10" fill="#2980b9" font-weight="bold">Host port 5501 → 5432</text>
    <text x="78" y="262" font-size="10" fill="#888">Volume: sales_data</text>
  </g>

  <!-- hr-db -->
  <g filter="url(#sh)">
    <rect x="335" y="105" width="230" height="165" rx="8" fill="#fff" stroke="#27ae60" stroke-width="2"/>
    <rect x="335" y="105" width="230" height="36" rx="8" fill="#27ae60"/>
    <rect x="335" y="130" width="230" height="11" fill="#27ae60"/>
    <text x="450" y="130" text-anchor="middle" font-size="14" font-weight="bold" fill="#fff">hr-db</text>
    <text x="353" y="162" font-size="11" fill="#333">PostgreSQL 16</text>
    <text x="353" y="180" font-size="11" fill="#555">Database: hr</text>
    <text x="353" y="198" font-size="11" fill="#555">Tables: departments, employees,</text>
    <text x="405" y="213" font-size="11" fill="#555">timesheets</text>
    <text x="353" y="232" font-size="10" fill="#888">Normalized (3NF)</text>
    <line x1="345" y1="242" x2="555" y2="242" stroke="#eee" stroke-width="1"/>
    <text x="353" y="257" font-size="10" fill="#27ae60" font-weight="bold">Host port 5502 → 5432</text>
    <text x="353" y="271" font-size="10" fill="#888">Volume: hr_data</text>
  </g>

  <!-- warehouse-db -->
  <g filter="url(#sh)">
    <rect x="610" y="105" width="230" height="165" rx="8" fill="#fff" stroke="#c0392b" stroke-width="2"/>
    <rect x="610" y="105" width="230" height="36" rx="8" fill="#c0392b"/>
    <rect x="610" y="130" width="230" height="11" fill="#c0392b"/>
    <text x="725" y="130" text-anchor="middle" font-size="14" font-weight="bold" fill="#fff">warehouse-db</text>
    <text x="628" y="162" font-size="11" fill="#333">PostgreSQL 16</text>
    <text x="628" y="180" font-size="11" fill="#555">Database: warehouse</text>
    <text x="628" y="198" font-size="11" fill="#555">Tables: fact_sales, dim_date,</text>
    <text x="672" y="213" font-size="11" fill="#555">dim_customer, dim_product,</text>
    <text x="672" y="228" font-size="11" fill="#555">dim_employee</text>
    <text x="628" y="246" font-size="10" fill="#888">Star Schema (denormalized)</text>
    <line x1="620" y1="255" x2="830" y2="255" stroke="#eee" stroke-width="1"/>
    <text x="628" y="262" font-size="10" fill="#c0392b" font-weight="bold">Host port 5503 → 5432</text>
  </g>

  <!-- =============== ROW 2: ETL Service =============== -->

  <g filter="url(#sh)">
    <rect x="225" y="330" width="280" height="120" rx="8" fill="#fff" stroke="#e67e22" stroke-width="2"/>
    <rect x="225" y="330" width="280" height="36" rx="8" fill="#e67e22"/>
    <rect x="225" y="355" width="280" height="11" fill="#e67e22"/>
    <text x="365" y="355" text-anchor="middle" font-size="14" font-weight="bold" fill="#fff">etl-service</text>
    <text x="243" y="387" font-size="11" fill="#333">Python 3 + cron</text>
    <text x="243" y="405" font-size="11" fill="#555">Runs etl_script.py on startup,</text>
    <text x="243" y="420" font-size="11" fill="#555">then every 5 min via cron (*/5 * * * *)</text>
    <text x="243" y="440" font-size="10" fill="#e67e22" font-weight="bold">No host port — internal only</text>
  </g>

  <!-- depends_on label -->
  <rect x="255" y="307" width="220" height="18" rx="4" fill="#fef9e7" stroke="#f5cba7" stroke-width="1"/>
  <text x="365" y="320" text-anchor="middle" font-size="9" fill="#e67e22">depends_on: all 3 DBs healthy</text>

  <!-- =============== ROW 3: pgAdmin =============== -->

  <g filter="url(#sh)">
    <rect x="560" y="370" width="240" height="100" rx="8" fill="#fff" stroke="#7f8c8d" stroke-width="2"/>
    <rect x="560" y="370" width="240" height="36" rx="8" fill="#34495e"/>
    <rect x="560" y="395" width="240" height="11" fill="#34495e"/>
    <text x="680" y="395" text-anchor="middle" font-size="14" font-weight="bold" fill="#fff">pgadmin</text>
    <text x="578" y="427" font-size="11" fill="#333">pgAdmin 4 (v8.13)</text>
    <text x="578" y="445" font-size="11" fill="#555">Web UI for all 3 databases</text>
    <text x="578" y="462" font-size="10" fill="#34495e" font-weight="bold">Host port 8200 → 80</text>
  </g>

  <!-- =============== ARROWS: ETL reads from sales-db and hr-db =============== -->

  <!-- sales-db → etl-service -->
  <line x1="175" y1="270" x2="175" y2="375" stroke="#2980b9" stroke-width="1.8" stroke-dasharray="none"/>
  <line x1="175" y1="375" x2="225" y2="375" stroke="#2980b9" stroke-width="1.8" marker-end="url(#arr-blue)"/>
  <rect x="100" y="290" width="70" height="18" rx="3" fill="#eaf2f8" stroke="#aed6f1" stroke-width="1"/>
  <text x="135" y="303" text-anchor="middle" font-size="9" fill="#2980b9" font-weight="bold">EXTRACT</text>

  <!-- hr-db → etl-service -->
  <line x1="450" y1="270" x2="450" y2="295" stroke="#27ae60" stroke-width="1.8"/>
  <line x1="450" y1="295" x2="400" y2="295" stroke="#27ae60" stroke-width="1.8"/>
  <line x1="400" y1="295" x2="400" y2="330" stroke="#27ae60" stroke-width="1.8" marker-end="url(#arr-green)"/>
  <rect x="455" y="277" width="70" height="18" rx="3" fill="#eafaf1" stroke="#a9dfbf" stroke-width="1"/>
  <text x="490" y="290" text-anchor="middle" font-size="9" fill="#27ae60" font-weight="bold">EXTRACT</text>

  <!-- etl-service → warehouse-db (LOAD) -->
  <line x1="505" y1="390" x2="540" y2="390" stroke="#c0392b" stroke-width="2.2"/>
  <line x1="540" y1="390" x2="540" y2="240" stroke="#c0392b" stroke-width="2.2"/>
  <line x1="540" y1="240" x2="610" y2="240" stroke="#c0392b" stroke-width="2.2" marker-end="url(#arr-red)"/>
  <rect x="542" y="300" width="55" height="18" rx="3" fill="#fdedec" stroke="#f5b7b1" stroke-width="1"/>
  <text x="569" y="313" text-anchor="middle" font-size="9" fill="#c0392b" font-weight="bold">LOAD</text>

  <!-- =============== ARROWS: pgAdmin connects to all 3 DBs =============== -->

  <!-- pgAdmin → sales-db (dashed, gray) -->
  <line x1="600" y1="470" x2="175" y2="470" stroke="#7f8c8d" stroke-width="1.2" stroke-dasharray="5,3"/>
  <line x1="175" y1="470" x2="175" y2="270" stroke="#7f8c8d" stroke-width="1.2" stroke-dasharray="5,3" marker-end="url(#arr-pgadmin)"/>

  <!-- pgAdmin → hr-db (dashed, gray) -->
  <line x1="630" y1="470" x2="450" y2="500" stroke="#7f8c8d" stroke-width="1.2" stroke-dasharray="5,3"/>
  <line x1="450" y1="500" x2="450" y2="270" stroke="#7f8c8d" stroke-width="1.2" stroke-dasharray="5,3" marker-end="url(#arr-pgadmin)"/>

  <!-- pgAdmin → warehouse-db (dashed, gray) -->
  <line x1="725" y1="370" x2="725" y2="270" stroke="#7f8c8d" stroke-width="1.2" stroke-dasharray="5,3" marker-end="url(#arr-pgadmin)"/>

  <!-- pgAdmin connection label -->
  <text x="680" y="510" text-anchor="middle" font-size="9" fill="#7f8c8d" font-style="italic">connects to all 3 databases</text>

  <!-- =============== HOST ACCESS (bottom) =============== -->
  <rect x="60" y="530" width="780" height="55" rx="6" fill="#f8f9fa" stroke="#ddd" stroke-width="1"/>
  <text x="80" y="552" font-size="12" font-weight="bold" fill="#2c3e50">Host Access (your laptop)</text>
  <text x="80" y="572" font-size="11" fill="#555">localhost:5501 → sales-db  |  localhost:5502 → hr-db  |  localhost:5503 → warehouse-db  |  localhost:8200 → pgAdmin</text>
</svg>
